import{j as e}from"./plugins-zOuqcpMR.js";import{a as A,r as a,_ as D}from"./ace-ERQk7LBk.js";import{T as N,M as L,c as S}from"./index-MhRWvM9V.js";import{e as P}from"./exportMarkdown-C0XcNpUB.js";const H=({event:o,editor:t,saveToStorage:n})=>{var r;if(o.ctrlKey)switch(o.key.toLowerCase()){case"b":o.preventDefault(),T("__",t);break;case"i":o.preventDefault(),T("_",t);break;case"s":o.preventDefault(),n();break;case"o":o.preventDefault(),(r=document.getElementById("entries-button"))==null||r.click();break}},T=(o,t)=>{if(!t)return;const n=t.getCursorPosition(),r=t.getSelectedText(),h=o.replace("<","</");if(r){const l=t.getSelectionRange();t.session.replace(l,`${o}${r}${h}`)}else{const l={row:n.row,column:n.column};t.session.insert(l,`${o}${h}`);const x={row:l.row,column:l.column+o.length};t.clearSelection(),t.moveCursorToPosition(x)}t.focus()},W=({isListVisible:o,toggleListVisibility:t})=>{const n=A.createRef(),r=a.useContext(N),{filename:h,markdown:l,timestamp:x,toVersion:g,isSaved:p,handleChange:m,filenameChange:j,timestampChange:k,toggleToVersion:$,saveToStorage:i}=a.useContext(L),{editor:s,changeEditor:C}=a.useContext(S);if(a.useEffect(()=>{const u=b=>{if(!(p||l===""))return b.preventDefault(),b.returnValue=""};return window.addEventListener("beforeunload",u),()=>{window.removeEventListener("beforeunload",u)}},[p,l]),a.useEffect(()=>{n.current&&C(n)},[n,C]),a.useEffect(()=>{const u=b=>{s&&(H({event:b,editor:s,saveToStorage:i}),b.ctrlKey&&b.key.toLowerCase()=="s"&&o&&t())};return document.addEventListener("keydown",u),()=>document.removeEventListener("keydown",u)},[s,h,o,l,i,x,g,t]),!r)return e.jsx("div",{children:"Error: Theme context is null"});const{theme:d}=r,c=u=>{if(!u.target.files)return;const b=u.target.files[0],w=new FileReader;w.onload=v=>{if(!v.target)return;const f=v.target.result;typeof f=="string"&&(m(f),j(b.name.replace(".md","")),k(new Date))},w.readAsText(b)},y=()=>{if(!s)return;const{session:u}=s;u.getUndoManager().undo(u)},E=()=>{if(!s)return;const{session:u}=s;u.getUndoManager().redo(u)};return e.jsxs(e.Fragment,{children:[e.jsx(B,{toggleListVisibility:t}),e.jsxs("div",{className:`file-input-group ${d}`,children:[e.jsx("label",{htmlFor:"filename-input",children:e.jsx("input",{type:"text",className:`filename-input ${d}`,name:"filename-input",value:h,onChange:u=>j(u.target.value),title:"Enter the name of your entry"})}),e.jsx("h4",{title:p?"Document is saved":"Unsaved changes",className:"status",children:p?"✔":"✘"}),e.jsxs("label",{className:`btn ${d}`,title:"Import a document into the editor",children:[e.jsx("input",{type:"file",onChange:c}),"Import"]}),e.jsx("label",{className:`btn ${d}`,title:"Export the active entry from the editor",onClick:()=>P({filename:h,markdown:l}),children:"Export"}),e.jsx("button",{className:`btn ${d}`,onClick:i,title:"Save the current entry in your browser",children:"Save"}),e.jsxs("button",{className:`btn ${d}`,onClick:$,title:g?"The editor is keeping a version history of your entry":"Version history is disabled",children:["Versioning: ",g?"ON":"NO"]}),e.jsxs("div",{children:[e.jsx("label",{className:`btn ${d}`,onClick:y,title:"Undo",children:"↺"}),e.jsx("label",{className:`btn ${d}`,onClick:E,title:"Redo",children:"⟳"})]})]}),e.jsx(D,{ref:n,mode:"markdown",theme:d==="light"?"github":"dracula",name:"id-ace-editor",fontSize:13,showPrintMargin:!1,onChange:m,value:l,className:"ace-editor",setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!0}})]})},U=({insertType:o,setShowInsertModal:t})=>{const[n,r]=a.useState(""),[h,l]=a.useState(""),[x,g]=a.useState(""),p=a.useContext(N),{editor:m}=a.useContext(S);if(!p)return e.jsx("div",{children:"Error: Theme context is null"});const{theme:j}=p,k=(i,s)=>{if(!s)return;const C=s.getCursorPosition(),d={row:C.row,column:C.column};s.session.insert(d,i),s.focus()},$=()=>{let i=`[${n}](${x})`;if(o==="image"&&(i="!"+i),o==="reference"&&(i=`[${n}][${h}]`),!!m){if(k(i,m),o==="reference"){const s=`[${h}]: ${x}`;if(!m)return;if(m.session.getLine(m.session.getLength()-1).trim()===""){const d={row:m.session.getLength()-1,column:0};m.session.insert(d,s)}else{const d={row:m.session.getLength(),column:0};m.session.insert(d,`
${s}`)}l("")}t(!1),r(""),g("")}};return e.jsxs("div",{className:`insert-modal ${j}`,children:[e.jsxs("p",{children:["Insert"," ",o.charAt(0).toUpperCase()+o.substring(1)]}),e.jsx("input",{type:"text",value:n,onChange:i=>r(i.target.value),placeholder:"Enter text here"}),o==="reference"&&e.jsx("input",{type:"text",value:h,onChange:i=>l(i.target.value),placeholder:"Enter reference here"}),e.jsx("input",{type:"text",value:x,onChange:i=>g(i.target.value),placeholder:"Enter link here"}),e.jsx("button",{className:`toolbar-button ${j}`,onClick:$,children:"Insert"})]})},M=()=>{const o=a.useContext(N),{editor:t}=a.useContext(S);if(!o)return e.jsx("div",{children:"Error: Theme context is null"});const{theme:n}=o,r=l=>{if(!t)return;const g={row:t.getCursorPosition().row,column:0};t.session.insert(g,l),t.focus()},h=l=>{const x=l.target.value;!x||!t||(r(`${"#".repeat(Number(x))} `),l.target.value="")};return e.jsxs(e.Fragment,{children:[e.jsxs("select",{title:"Choose a heading",className:`toolbar-select ${n}`,defaultValue:"",onChange:h,children:[e.jsx("option",{value:"",children:"Heading"}),e.jsx("option",{value:"1",children:"Heading 1"}),e.jsx("option",{value:"2",children:"Heading 2"}),e.jsx("option",{value:"3",children:"Heading 3"}),e.jsx("option",{value:"4",children:"Heading 4"}),e.jsx("option",{value:"5",children:"Heading 5"}),e.jsx("option",{value:"6",children:"Heading 6"})]}),e.jsx("button",{title:"Create bullet points",className:`toolbar-button ${n}`,onClick:()=>r("- "),children:"Unordered List"}),e.jsx("button",{title:"Create an ordered list",className:`toolbar-button ${n}`,onClick:()=>r("1. "),children:"Ordered List"}),e.jsx("button",{title:"Add a checkbox",className:`toolbar-button ${n}`,onClick:()=>r("- [ ] "),children:"Checkbox"}),e.jsx("button",{title:"Add a horizontal rule",className:`toolbar-button ${n}`,onClick:()=>r(`---
`),children:"Rule"}),e.jsx("button",{title:"Add a line break",className:`toolbar-button ${n}`,onClick:()=>r("<br>"),children:"Break"}),e.jsx("button",{title:"Indent text with block quotes",className:`toolbar-button ${n}`,onClick:()=>r("> "),children:"Quote"})]})},_=()=>{const o=a.useContext(N),{editor:t}=a.useContext(S),n=h=>{t&&T(h,t)};if(!o||!t)return e.jsxs("div",{children:["Error: ",t?"Theme":"Editor"," is null"]});const{theme:r}=o;return e.jsxs(e.Fragment,{children:[e.jsx("button",{title:"Bold text",className:`toolbar-button ${r}`,onClick:()=>n("__"),children:e.jsx("b",{children:"B"})}),e.jsx("button",{title:"Italic text",className:`toolbar-button ${r}`,onClick:()=>n("_"),children:e.jsx("i",{children:"I"})}),e.jsx("button",{title:"Underlined text",className:`toolbar-button ${r}`,onClick:()=>n("<ins>"),children:e.jsx("u",{children:"u"})}),e.jsx("button",{title:"Strike through text",className:`toolbar-button ${r}`,onClick:()=>n("~"),children:e.jsx("del",{children:"Strike"})}),e.jsx("button",{title:"Text as a subscript",className:`toolbar-button ${r}`,onClick:()=>n("<sub>"),children:"Sub"}),e.jsx("button",{title:"Text as a superscript",className:`toolbar-button ${r}`,onClick:()=>n("<sup>"),children:"Super"})]})},B=({toggleListVisibility:o})=>{const[t,n]=a.useState(!1),[r,h]=a.useState("link"),[l,x]=a.useState(!0),[g,p]=a.useState(""),[m,j]=a.useState(""),[k,$]=a.useState(!0),i=a.useContext(N),{editor:s}=a.useContext(S),{autosave:C,toggleAutosave:d}=a.useContext(L);if(!i)return e.jsx("div",{children:"Error: Theme context is null"});const{theme:c,toggleTheme:y}=i,E=()=>{s&&s.find(g,{caseSensitive:!1,wholeWord:!1,regExp:!1})},u=()=>{s&&s.replace(m)},b=()=>{s&&(s.replaceAll(m,{caseSensitive:!1,wholeWord:!1,regExp:!1}),s.clearSelection())},w=()=>{if(!s)return;const f=s.getCursorPosition(),R=s.session.getLine(f.row);let I=1;R.trim()!==""&&(s.insert(`
`),I=2),s.insert("```\n\n```"),s.moveCursorToPosition({row:f.row+I,column:0})},v=f=>{h(f),n(!t)};return e.jsxs("div",{className:`toolbar ${c}`,children:[e.jsx("button",{title:"Click to change theme",className:`toolbar-button ${c}`,onClick:y,children:e.jsx("i",{children:c==="light"?"DAWN":"DUSK"})}),e.jsx("button",{title:"List of all the entries saved on this device",className:`toolbar-button ${c}`,onClick:o,id:"entries-button",children:e.jsx("i",{children:"Entries"})}),e.jsx("button",{className:`toolbar-button ${c}`,onClick:d,title:C?"Autosaving every 2 minutes":"Autosaving is currently disabled",children:e.jsx("i",{children:C?"Auto":"Hold"})}),e.jsx("button",{className:`toolbar-button ${c}`,onClick:()=>{confirm("You are about erase to all your data in this app including your entries.")&&(localStorage.clear(),location.reload())},title:"Clear your data in this app",children:e.jsx("i",{children:"Clear"})}),e.jsx("button",{className:`toolbar-button ${c}`,onClick:()=>x(!l),title:l?"Open toolbar":"Close toolbar",children:e.jsx("i",{children:l?">":"X"})}),!l&&e.jsxs(e.Fragment,{children:[e.jsx(_,{}),e.jsx(M,{}),e.jsx("button",{className:`toolbar-button ${c}`,onClick:w,title:"Create code block",children:"Code"}),e.jsxs("div",{children:[e.jsx("button",{title:"Insert a link",className:`toolbar-button ${c}`,onClick:()=>v("link"),children:"Link"}),e.jsx("button",{title:"Insert an image",className:`toolbar-button ${c}`,onClick:()=>v("image"),children:"Image"}),e.jsx("button",{title:"Insert a link reference",className:`toolbar-button ${c}`,onClick:()=>v("reference"),children:"Reference"})]}),e.jsx("button",{title:`Click to ${k?"open":"close"} search modal`,className:`toolbar-button ${c}`,onClick:()=>$(!k),children:"🔍"}),!k&&e.jsxs("div",{className:`search-modal ${c}`,children:[e.jsx("input",{type:"text",placeholder:"Search",onChange:f=>p(f.target.value)}),e.jsx("button",{className:`toolbar-button ${c}`,onClick:E,children:"Search"}),e.jsx("input",{type:"text",placeholder:"Replace",onChange:f=>j(f.target.value)}),e.jsx("button",{className:`toolbar-button ${c}`,onClick:u,children:"Replace"}),e.jsx("button",{className:`toolbar-button ${c}`,onClick:b,children:"Replace All"})]}),t&&e.jsx(U,{insertType:r,setShowInsertModal:n})]})]})};export{W as default};
//# sourceMappingURL=index-0_VoH3IF.js.map
