import{j as s}from"./plugins-2QKNzetD.js";import{r as o}from"./ace-ERQk7LBk.js";import{M as E,T as C,u as v,g as l,L as T}from"./index-cG9zMz_t.js";import{e as x}from"./exportMarkdown-prvLWrxa.js";const L=({closeList:d})=>{const[r,f]=o.useState([]),[c,h]=o.useState([]),{handleChange:k,filenameChange:b,timestampChange:g}=o.useContext(E),{theme:a}=o.useContext(C),w=v();o.useEffect(()=>{const t=Object.entries(localStorage).filter(([n])=>n.startsWith("Entry: ")).map(([n,i])=>({filename:n.replace("Entry: ","").split(" :~~: ")[0],markdown:i,timestamp:new Date(n.replace("Entry: ","").split(" :~~: ")[1])})),e=Object.values(t.reduce((n,{filename:i,markdown:m,timestamp:p})=>(n[i]||(n[i]=[]),n[i].push({filename:i,markdown:m,timestamp:p}),n),{})).map(n=>(n.sort((i,m)=>m.timestamp.getTime()-i.timestamp.getTime()),{entryName:n[0].filename,entries:n}));e.sort((n,i)=>i.entries[0].timestamp.getTime()-n.entries[0].timestamp.getTime()),h(e)},[d]);const N=t=>{f(e=>e.includes(t)?e.filter(n=>n!==t):e.length<2?[...e,t]:e)},$=()=>{if(r.length!==2)return;const t=`${r[0].filename}@${l(r[0].timestamp)}`,e=`${r[1].filename}@${l(r[1].timestamp)}`;w(`/mdwrite/previews/p1/${t}/p2/${e}`)},u=t=>{b(t.filename),k(t.markdown),g(t.timestamp),d()},j=t=>{const{timeZone:e}=Intl.DateTimeFormat().resolvedOptions(),n=t.timestamp.toLocaleString("en-US",{timeZone:e});localStorage.removeItem(`Entry: ${t.filename} :~~: ${n}`);const i=c.map(m=>m.entryName===t.filename?{...m,entries:m.entries.filter(p=>p.timestamp!==t.timestamp)}:m);h(i)};return s.jsxs("div",{className:`entry-list ${a}`,children:[s.jsx("h2",{className:`entry-list-heading ${a}`,children:"Saved Entries"}),s.jsxs("div",{className:"header-button-container",children:[s.jsx("button",{className:`entry-button ${a}`,title:"Open a new entry in the editor",onClick:()=>u({filename:"untitled",markdown:"",timestamp:new Date}),children:"New Entry"},"New Entry"),s.jsx("button",{className:`entry-button ${a}`,title:"Mark two entries to open a preview",onClick:$,children:"Preview"},"Preview")]}),c.length==0?s.jsx("div",{className:`entry-title ${a}`,children:"No entry"}):c.map(t=>t.entries.length>0&&s.jsxs("div",{children:[s.jsx("div",{className:`entry-title ${a}`,children:t.entryName.length>50?t.entryName.substring(0,70)+"...":t.entryName}),t.entries.map(e=>s.jsxs("div",{className:"entry",children:[s.jsx("br",{}),s.jsxs("label",{title:"Check to preview",className:`checkbox-container ${a}`,children:[s.jsx("input",{type:"checkbox",name:"myCheckbox",checked:r.includes(e),onChange:()=>N(e)}),s.jsx("span",{className:`checkbox-checkmark ${a}`})]}),s.jsxs("button",{title:`${e.filename} from ${e.timestamp.toDateString()}`,className:`entry-button ${a}`,onClick:()=>u(e),children:[l(e.timestamp)," "]}),s.jsx(T,{title:"Open entry in new tab",to:"entry/"+e.filename+"@"+l(e.timestamp),target:"_blank",children:s.jsx("h3",{children:"[â†—]"})}),s.jsx("button",{title:`Export as ${e.filename}.md`,className:`export-button ${a}`,onClick:()=>x({filename:e.filename,markdown:e.markdown}),children:"Export"}),s.jsx("button",{title:`Export as ${e.filename}.md`,className:`export-button ${a}`,onClick:()=>x({filename:e.filename+"@"+l(e.timestamp),markdown:e.markdown}),children:"@"}),s.jsx("button",{title:`Delete this version of ${e.filename}`,className:"delete-button",onClick:()=>j(e),children:"Delete"})]},e.timestamp.toString()))]},t.entryName))]})};export{L as default};
//# sourceMappingURL=index-bl5VB9ys.js.map
