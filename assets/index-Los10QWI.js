import{j as e}from"./plugins-q0mUWLr-.js";import{R as A,r as l,_ as P}from"./ace-T5rmW5Lp.js";import{T as v,M as L,E as N}from"./index-G1RmKFi7.js";import{e as H}from"./exportMarkdown-FI0QSQ96.js";const D=({event:s,editor:t,saveToStorage:o})=>{if(s.ctrlKey)switch(s.key.toLowerCase()){case"b":s.preventDefault(),E("__",t);break;case"i":s.preventDefault(),E("_",t);break;case"s":s.preventDefault(),o();break}},E=(s,t)=>{if(!t)return;const o=t.getCursorPosition(),r=t.getSelectedText(),u=s.replace("<","</");if(r){const i=t.getSelectionRange();t.session.replace(i,`${s}${r}${u}`)}else{const i={row:o.row,column:o.column};t.session.insert(i,`${s}${u}`);const d={row:i.row,column:i.column+s.length};t.clearSelection(),t.moveCursorToPosition(d)}t.focus()},W=({toggleListVisibility:s})=>{const t=A.createRef(),o=l.useContext(v),{filename:r,markdown:u,timestamp:i,toVersion:d,handleChange:b,filenameChange:k,timestampChange:x,toggleToVersion:$,saveToStorage:g}=l.useContext(L),{editor:m,changeEditor:a}=l.useContext(N);if(l.useEffect(()=>{t.current&&a(t)},[t,a]),l.useEffect(()=>{const h=p=>{m&&D({event:p,editor:m,saveToStorage:g})};return document.addEventListener("keydown",h),()=>document.removeEventListener("keydown",h)},[m,r,u,g,i,d]),!o)return e.jsx("div",{children:"Error: Theme context is null"});const{theme:n}=o,C=h=>{if(!h.target.files)return;const p=h.target.files[0],S=new FileReader;S.onload=w=>{if(!w.target)return;const T=w.target.result;typeof T=="string"&&(b(T),k(p.name.replace(".md","")),x(new Date))},S.readAsText(p)},f=()=>{if(!m)return;const{session:h}=m;h.getUndoManager().undo(h)},c=()=>{if(!m)return;const{session:h}=m;h.getUndoManager().redo(h)};return e.jsxs(e.Fragment,{children:[e.jsx(F,{toggleListVisibility:s}),e.jsxs("div",{className:`file-input-group ${n}`,children:[e.jsx("label",{htmlFor:"filename-input",children:e.jsx("input",{type:"text",className:`filename-input ${n}`,name:"filename-input",value:r,onChange:h=>k(h.target.value),title:"Enter the name of your entry"})}),e.jsxs("label",{className:`btn ${n}`,title:"Import a document into the editor",children:[e.jsx("input",{type:"file",onChange:C}),"Import"]}),e.jsx("label",{className:`btn ${n}`,title:"Export the active entry from the editor",onClick:()=>H({filename:r,markdown:u}),children:"Export"}),e.jsx("button",{className:`btn ${n}`,onClick:g,title:"Save the current entry in your browser",children:"Save"}),e.jsxs("button",{className:`btn ${n}`,onClick:$,title:d?"The editor is keeping a version history of your entry":"Version history is disabled",children:["Versioning: ",d?"ON":"NO"]}),e.jsxs("div",{children:[e.jsx("label",{className:`btn ${n}`,onClick:f,title:"Undo",children:"↺"}),e.jsx("label",{className:`btn ${n}`,onClick:c,title:"Redo",children:"⟳"})]})]}),e.jsx(P,{ref:t,mode:"markdown",theme:n==="light"?"github":"dracula",name:"id-ace-editor",fontSize:13,showPrintMargin:!1,onChange:b,value:u,className:"ace-editor",setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!0}})]})},M=({insertType:s,setShowInsertModal:t})=>{const[o,r]=l.useState(""),[u,i]=l.useState(""),[d,b]=l.useState(""),k=l.useContext(v),{editor:x}=l.useContext(N);if(!k)return e.jsx("div",{children:"Error: Theme context is null"});const{theme:$}=k,g=(a,n)=>{if(!n)return;const C=n.getCursorPosition(),f={row:C.row,column:C.column};n.session.insert(f,a),n.focus()},m=()=>{let a=`[${o}](${d})`;if(s==="image"&&(a="!"+a),s==="reference"&&(a=`[${o}][${u}]`),!!x){if(g(a,x),s==="reference"){const n=`[${u}]: ${d}`;if(!x)return;if(x.session.getLine(x.session.getLength()-1).trim()===""){const f={row:x.session.getLength()-1,column:0};x.session.insert(f,n)}else{const f={row:x.session.getLength(),column:0};x.session.insert(f,`
${n}`)}i("")}t(!1),r(""),b("")}};return e.jsxs("div",{className:`insert-modal ${$}`,children:[e.jsxs("p",{children:["Insert"," ",s.charAt(0).toUpperCase()+s.substring(1)]}),e.jsx("input",{type:"text",value:o,onChange:a=>r(a.target.value),placeholder:"Enter text here"}),s==="reference"&&e.jsx("input",{type:"text",value:u,onChange:a=>i(a.target.value),placeholder:"Enter reference here"}),e.jsx("input",{type:"text",value:d,onChange:a=>b(a.target.value),placeholder:"Enter link here"}),e.jsx("button",{className:`toolbar-button ${$}`,onClick:m,children:"Insert"})]})},U=()=>{const s=l.useContext(v),{editor:t}=l.useContext(N);if(!s)return e.jsx("div",{children:"Error: Theme context is null"});const{theme:o}=s,r=i=>{if(!t)return;const b={row:t.getCursorPosition().row,column:0};t.session.insert(b,i),t.focus()},u=i=>{const d=i.target.value;!d||!t||(r(`${"#".repeat(Number(d))} `),i.target.value="")};return e.jsxs(e.Fragment,{children:[e.jsxs("select",{title:"Choose a heading",className:`toolbar-select ${o}`,defaultValue:"",onChange:u,children:[e.jsx("option",{value:"",children:"Heading"}),e.jsx("option",{value:"1",children:"Heading 1"}),e.jsx("option",{value:"2",children:"Heading 2"}),e.jsx("option",{value:"3",children:"Heading 3"}),e.jsx("option",{value:"4",children:"Heading 4"}),e.jsx("option",{value:"5",children:"Heading 5"}),e.jsx("option",{value:"6",children:"Heading 6"})]}),e.jsx("button",{title:"Create bullet points",className:`toolbar-button ${o}`,onClick:()=>r("- "),children:"Unordered List"}),e.jsx("button",{title:"Create an ordered list",className:`toolbar-button ${o}`,onClick:()=>r("1. "),children:"Ordered List"}),e.jsx("button",{title:"Add a checkbox",className:`toolbar-button ${o}`,onClick:()=>r("- [ ] "),children:"Checkbox"}),e.jsx("button",{title:"Add a horizontal rule",className:`toolbar-button ${o}`,onClick:()=>r(`---
`),children:"Rule"}),e.jsx("button",{title:"Add a line break",className:`toolbar-button ${o}`,onClick:()=>r("<br>"),children:"Break"}),e.jsx("button",{title:"Indent text with block quotes",className:`toolbar-button ${o}`,onClick:()=>r("> "),children:"Quote"})]})},_=()=>{const s=l.useContext(v),{editor:t}=l.useContext(N),o=u=>{t&&E(u,t)};if(!s||!t)return e.jsxs("div",{children:["Error: ",t?"Theme":"Editor"," is null"]});const{theme:r}=s;return e.jsxs(e.Fragment,{children:[e.jsx("button",{title:"Bold text",className:`toolbar-button ${r}`,onClick:()=>o("__"),children:e.jsx("b",{children:"B"})}),e.jsx("button",{title:"Italic text",className:`toolbar-button ${r}`,onClick:()=>o("_"),children:e.jsx("i",{children:"I"})}),e.jsx("button",{title:"Underlined text",className:`toolbar-button ${r}`,onClick:()=>o("<ins>"),children:e.jsx("u",{children:"u"})}),e.jsx("button",{title:"Strike through text",className:`toolbar-button ${r}`,onClick:()=>o("~"),children:e.jsx("del",{children:"Strike"})}),e.jsx("button",{title:"Text as a subscript",className:`toolbar-button ${r}`,onClick:()=>o("<sub>"),children:"Sub"}),e.jsx("button",{title:"Text as a superscript",className:`toolbar-button ${r}`,onClick:()=>o("<sup>"),children:"Super"})]})},F=({toggleListVisibility:s})=>{const[t,o]=l.useState(!1),[r,u]=l.useState("link"),[i,d]=l.useState(!0),[b,k]=l.useState(""),[x,$]=l.useState(""),[g,m]=l.useState(!0),a=l.useContext(v),{editor:n}=l.useContext(N),{autosave:C,toggleAutosave:f}=l.useContext(L);if(!a)return e.jsx("div",{children:"Error: Theme context is null"});const{theme:c,toggleTheme:h}=a,p=()=>{n&&n.find(b,{caseSensitive:!1,wholeWord:!1,regExp:!1})},S=()=>{n&&n.replace(x)},w=()=>{n&&(n.replaceAll(x,{caseSensitive:!1,wholeWord:!1,regExp:!1}),n.clearSelection())},T=()=>{if(!n)return;const j=n.getCursorPosition(),R=n.session.getLine(j.row);let I=1;R.trim()!==""&&(n.insert(`
`),I=2),n.insert("```\n\n```"),n.moveCursorToPosition({row:j.row+I,column:0})},y=j=>{u(j),o(!t)};return e.jsxs("div",{className:`toolbar ${c}`,children:[e.jsx("button",{title:"Click to change theme",className:`toolbar-button ${c}`,onClick:h,children:e.jsx("i",{children:c==="light"?"DAWN":"DUSK"})}),e.jsx("button",{title:"List of all the entries saved on this device",className:`toolbar-button ${c}`,onClick:s,children:e.jsx("i",{children:"Entries"})}),e.jsx("button",{className:`toolbar-button ${c}`,onClick:f,title:C?"Autosaving every 2 minutes":"Autosaving is currently disabled",children:e.jsx("i",{children:C?"Auto":"Hold"})}),e.jsx("button",{className:`toolbar-button ${c}`,onClick:()=>d(!i),title:i?"Open toolbar":"Close toolbar",children:e.jsx("i",{children:i?">":"X"})}),!i&&e.jsxs(e.Fragment,{children:[e.jsx(_,{}),e.jsx(U,{}),e.jsx("button",{className:`toolbar-button ${c}`,onClick:T,title:"Create code block",children:"Code"}),e.jsxs("div",{children:[e.jsx("button",{title:"Insert a link",className:`toolbar-button ${c}`,onClick:()=>y("link"),children:"Link"}),e.jsx("button",{title:"Insert an image",className:`toolbar-button ${c}`,onClick:()=>y("image"),children:"Image"}),e.jsx("button",{title:"Insert a link reference",className:`toolbar-button ${c}`,onClick:()=>y("reference"),children:"Reference"})]}),e.jsx("button",{title:`Click to ${g?"open":"close"} search modal`,className:`toolbar-button ${c}`,onClick:()=>m(!g),children:"🔍"}),!g&&e.jsxs("div",{className:`search-modal ${c}`,children:[e.jsx("input",{type:"text",placeholder:"Search",onChange:j=>k(j.target.value)}),e.jsx("button",{className:`toolbar-button ${c}`,onClick:p,children:"Search"}),e.jsx("input",{type:"text",placeholder:"Replace",onChange:j=>$(j.target.value)}),e.jsx("button",{className:`toolbar-button ${c}`,onClick:S,children:"Replace"}),e.jsx("button",{className:`toolbar-button ${c}`,onClick:w,children:"Replace All"})]}),t&&e.jsx(M,{insertType:r,setShowInsertModal:o})]})]})};export{W as default};
//# sourceMappingURL=index-Los10QWI.js.map
