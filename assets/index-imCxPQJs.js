import{j as s}from"./plugins-2QKNzetD.js";import{r as o}from"./ace-ERQk7LBk.js";import{M as E,T as C,u as v,g as l,L as T}from"./index-L9p5gOat.js";import{e as x}from"./exportMarkdown--8Sb0DkQ.js";const M=({closeList:d})=>{const[r,f]=o.useState([]),[c,h]=o.useState([]),{handleChange:k,filenameChange:b,timestampChange:g}=o.useContext(E),{theme:a}=o.useContext(C),w=v();o.useEffect(()=>{const n=Object.entries(localStorage).filter(([t])=>t.startsWith("Entry: ")).map(([t,i])=>({filename:t.replace("Entry: ","").split(" :~~: ")[0],markdown:i,timestamp:new Date(t.replace("Entry: ","").split(" :~~: ")[1])})),e=Object.values(n.reduce((t,{filename:i,markdown:m,timestamp:p})=>(t[i]||(t[i]=[]),t[i].push({filename:i,markdown:m,timestamp:p}),t),{})).map(t=>(t.sort((i,m)=>m.timestamp.getTime()-i.timestamp.getTime()),{entryName:t[0].filename,entries:t}));e.sort((t,i)=>i.entries[0].timestamp.getTime()-t.entries[0].timestamp.getTime()),h(e)},[d]);const N=n=>{f(e=>e.includes(n)?e.filter(t=>t!==n):e.length<2?[...e,n]:e)},$=()=>{if(r.length!==2)return;const n=`${r[0].filename}@${l(r[0].timestamp)}`,e=`${r[1].filename}@${l(r[1].timestamp)}`;w(`/mdwrite/previews/p1/${n}/p2/${e}`)},u=n=>{const{filename:e,timestamp:t,markdown:i}=n;b(e),g(t),k(i,t,e),d()},j=n=>{const{timeZone:e}=Intl.DateTimeFormat().resolvedOptions(),t=n.timestamp.toLocaleString("en-US",{timeZone:e});localStorage.removeItem(`Entry: ${n.filename} :~~: ${t}`);const i=c.map(m=>m.entryName===n.filename?{...m,entries:m.entries.filter(p=>p.timestamp!==n.timestamp)}:m);h(i)};return s.jsxs("div",{className:`entry-list ${a}`,children:[s.jsx("h2",{className:`entry-list-heading ${a}`,children:"Saved Entries"}),s.jsxs("div",{className:"header-button-container",children:[s.jsx("button",{className:`entry-button ${a}`,title:"Open a new entry in the editor",onClick:()=>u({filename:"untitled",markdown:"",timestamp:new Date}),children:"New Entry"},"New Entry"),s.jsx("button",{className:`entry-button ${a}`,title:"Mark two entries to open a preview",onClick:$,children:"Preview"},"Preview")]}),c.length==0?s.jsx("div",{className:`entry-title ${a}`,children:"No entry"}):c.map(n=>n.entries.length>0&&s.jsxs("div",{children:[s.jsx("div",{className:`entry-title ${a}`,children:n.entryName.length>50?n.entryName.substring(0,70)+"...":n.entryName}),n.entries.map(e=>s.jsxs("div",{className:"entry",children:[s.jsx("br",{}),s.jsxs("label",{title:"Check to preview",className:`checkbox-container ${a}`,children:[s.jsx("input",{type:"checkbox",name:"myCheckbox",checked:r.includes(e),onChange:()=>N(e)}),s.jsx("span",{className:`checkbox-checkmark ${a}`})]}),s.jsxs("button",{title:`${e.filename} from ${e.timestamp.toDateString()}`,className:`entry-button ${a}`,onClick:()=>u(e),children:[l(e.timestamp)," "]}),s.jsx(T,{title:"Open entry in new tab",to:"entry/"+e.filename+"@"+l(e.timestamp),target:"_blank",children:s.jsx("h3",{children:"[â†—]"})}),s.jsx("button",{title:`Export as ${e.filename}.md`,className:`export-button ${a}`,onClick:()=>x({filename:e.filename,markdown:e.markdown}),children:"Export"}),s.jsx("button",{title:`Export as ${e.filename}.md`,className:`export-button ${a}`,onClick:()=>x({filename:e.filename+"@"+l(e.timestamp),markdown:e.markdown}),children:"@"}),s.jsx("button",{title:`Delete this version of ${e.filename}`,className:"delete-button",onClick:()=>j(e),children:"Delete"})]},e.timestamp.toString()))]},n.entryName))]})};export{M as default};
//# sourceMappingURL=index-imCxPQJs.js.map
